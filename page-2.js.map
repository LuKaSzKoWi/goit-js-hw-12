{"version":3,"file":"page-2.js","sources":["../src/js/01-searchapp.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\n// Elementy DOM\nconst form = document.getElementById('search-form');\nconst gallery = document.getElementById('gallery');\nconst loader = document.getElementById('loader');\nconst loadMoreBtn = document.getElementById('load-more');\n\n// Klucz API Pixabay\nconst API_KEY = '45947467-1fb23e21d26a094164d331d1f';\n\n// Zmienna globalna dla zarządzania paginacją\nlet query = '';\nlet page = 1;\nlet totalHits = 0;\n\n// Obsługa formularza\nform.addEventListener('submit', async (e) => {\n  e.preventDefault();\n  query = document.getElementById('query').value.trim();\n\n  // Walidacja pustego zapytania\n  if (!query) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Please enter a search term!',\n    });\n    return;\n  }\n\n  // Resetowanie wyników i paginacji\n  clearGallery();\n  page = 1;\n  loadMoreBtn.classList.add('hidden'); // Ukryj przycisk \"Load more\"\n  showLoader();\n\n  try {\n    const data = await fetchImages(query, page);\n    totalHits = data.totalHits;\n\n    hideLoader();\n\n    if (data.hits.length === 0) {\n      iziToast.info({\n        message: 'Sorry, there are no images matching your search query. Please try again!',\n      });\n      return;\n    }\n\n    displayImages(data.hits);\n\n    if (data.hits.length < totalHits) {\n      loadMoreBtn.classList.remove('hidden'); // Pokaż przycisk, jeśli są więcej wyników\n    }\n  } catch (error) {\n    handleError();\n  }\n});\n\n// Funkcja do pobierania obrazów\nasync function fetchImages(query, page) {\n  const URL = `https://pixabay.com/api/?key=${API_KEY}&q=${encodeURIComponent(query)}&image_type=photo&orientation=horizontal&safesearch=true&page=${page}&per_page=40`;\n  const response = await axios.get(URL);\n  return response.data;\n}\n\n// Wyświetlanie obrazów\nfunction displayImages(images) {\n  gallery.insertAdjacentHTML(\n    'beforeend',\n    images\n      .map(\n        (img) => `\n        <a href=\"${img.largeImageURL}\" class=\"gallery-item\">\n          <img src=\"${img.webformatURL}\" alt=\"${img.tags}\" />\n          <div class=\"info\">\n            <p>Likes: ${img.likes}</p>\n            <p>Views: ${img.views}</p>\n            <p>Comments: ${img.comments}</p>\n            <p>Downloads: ${img.downloads}</p>\n          </div>\n        </a>`\n      )\n      .join('')\n  );\n\n  refreshLightbox(); // Odświeżenie galerii SimpleLightbox\n}\n\n// Paginacja: Obsługa kliknięcia przycisku \"Load more\"\nloadMoreBtn.addEventListener('click', async () => {\n  page += 1;\n  showLoader();\n\n  try {\n    const data = await fetchImages(query, page);\n    displayImages(data.hits);\n\n    if (page * 40 >= totalHits) {\n      loadMoreBtn.classList.add('hidden'); // Ukryj przycisk, gdy dotrzesz do końca\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    }\n    \n    scrollToNextBatch();\n  } catch (error) {\n    handleError();\n  } finally {\n    hideLoader();\n  }\n});\n\n// Wyczyść galerię\nfunction clearGallery() {\n  gallery.innerHTML = '';\n}\n\n// Pokaż loader\nfunction showLoader() {\n  loader.classList.remove('hidden');\n}\n\n// Ukryj loader\nfunction hideLoader() {\n  loader.classList.add('hidden');\n}\n\n// Odświeżanie SimpleLightbox\nfunction refreshLightbox() {\n  const lightbox = new SimpleLightbox('.gallery-item', {\n    captionsData: 'alt',\n    captionDelay: 250,\n  });\n  lightbox.refresh();\n}\n\n// Płynne przewijanie\nfunction scrollToNextBatch() {\n  const { height: cardHeight } = gallery.firstElementChild.getBoundingClientRect();\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n\n// Obsługa błędów\nfunction handleError() {\n  iziToast.error({\n    title: 'Error',\n    message: 'Something went wrong. Please try again later.',\n  });\n  hideLoader();\n}\n"],"names":["form","gallery","loader","loadMoreBtn","API_KEY","query","page","totalHits","e","iziToast","clearGallery","showLoader","data","fetchImages","hideLoader","displayImages","handleError","URL","axios","images","img","refreshLightbox","scrollToNextBatch","SimpleLightbox","cardHeight"],"mappings":"sJAOA,MAAMA,EAAO,SAAS,eAAe,aAAa,EAC5CC,EAAU,SAAS,eAAe,SAAS,EAC3CC,EAAS,SAAS,eAAe,QAAQ,EACzCC,EAAc,SAAS,eAAe,WAAW,EAGjDC,EAAU,qCAGhB,IAAIC,EAAQ,GACRC,EAAO,EACPC,EAAY,EAGhBP,EAAK,iBAAiB,SAAU,MAAOQ,GAAM,CAK3C,GAJAA,EAAE,eAAc,EAChBH,EAAQ,SAAS,eAAe,OAAO,EAAE,MAAM,OAG3C,CAACA,EAAO,CACVI,EAAS,MAAM,CACb,MAAO,QACP,QAAS,6BACf,CAAK,EACD,MACD,CAGDC,IACAJ,EAAO,EACPH,EAAY,UAAU,IAAI,QAAQ,EAClCQ,IAEA,GAAI,CACF,MAAMC,EAAO,MAAMC,EAAYR,EAAOC,CAAI,EAK1C,GAJAC,EAAYK,EAAK,UAEjBE,IAEIF,EAAK,KAAK,SAAW,EAAG,CAC1BH,EAAS,KAAK,CACZ,QAAS,0EACjB,CAAO,EACD,MACD,CAEDM,EAAcH,EAAK,IAAI,EAEnBA,EAAK,KAAK,OAASL,GACrBJ,EAAY,UAAU,OAAO,QAAQ,CAExC,MAAe,CACda,GACD,CACH,CAAC,EAGD,eAAeH,EAAYR,EAAOC,EAAM,CACtC,MAAMW,EAAM,gCAAgCb,CAAO,MAAM,mBAAmBC,CAAK,CAAC,iEAAiEC,CAAI,eAEvJ,OADiB,MAAMY,EAAM,IAAID,CAAG,GACpB,IAClB,CAGA,SAASF,EAAcI,EAAQ,CAC7BlB,EAAQ,mBACN,YACAkB,EACG,IACEC,GAAQ;AAAA,mBACEA,EAAI,aAAa;AAAA,sBACdA,EAAI,YAAY,UAAUA,EAAI,IAAI;AAAA;AAAA,wBAEhCA,EAAI,KAAK;AAAA,wBACTA,EAAI,KAAK;AAAA,2BACNA,EAAI,QAAQ;AAAA,4BACXA,EAAI,SAAS;AAAA;AAAA,aAGlC,EACA,KAAK,EAAE,CACd,EAEEC,GACF,CAGAlB,EAAY,iBAAiB,QAAS,SAAY,CAChDG,GAAQ,EACRK,IAEA,GAAI,CACF,MAAMC,EAAO,MAAMC,EAAYR,EAAOC,CAAI,EAC1CS,EAAcH,EAAK,IAAI,EAEnBN,EAAO,IAAMC,IACfJ,EAAY,UAAU,IAAI,QAAQ,EAClCM,EAAS,KAAK,CACZ,QAAS,4DACjB,CAAO,GAGHa,GACD,MAAe,CACdN,GACJ,QAAY,CACRF,GACD,CACH,CAAC,EAGD,SAASJ,GAAe,CACtBT,EAAQ,UAAY,EACtB,CAGA,SAASU,GAAa,CACpBT,EAAO,UAAU,OAAO,QAAQ,CAClC,CAGA,SAASY,GAAa,CACpBZ,EAAO,UAAU,IAAI,QAAQ,CAC/B,CAGA,SAASmB,GAAkB,CACR,IAAIE,EAAe,gBAAiB,CACnD,aAAc,MACd,aAAc,GAClB,CAAG,EACQ,QAAO,CAClB,CAGA,SAASD,GAAoB,CAC3B,KAAM,CAAE,OAAQE,CAAU,EAAKvB,EAAQ,kBAAkB,wBACzD,OAAO,SAAS,CACd,IAAKuB,EAAa,EAClB,SAAU,QACd,CAAG,CACH,CAGA,SAASR,GAAc,CACrBP,EAAS,MAAM,CACb,MAAO,QACP,QAAS,+CACb,CAAG,EACDK,GACF"}